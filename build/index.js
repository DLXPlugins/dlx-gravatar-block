(()=>{"use strict";var a={n:e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},d:(e,t)=>{for(var r in t)a.o(t,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o:(a,e)=>Object.prototype.hasOwnProperty.call(a,e)};const e=window.wp.blocks,t=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","title":"Gravatar Block","apiVersion":3,"name":"dlxplugins/gravatar-block","category":"media","icon":"admin-users","description":"An Gravatar block.","keywords":["avatar","gravatar"],"version":"1.0.0","textdomain":"dlx-gravatar-block","attributes":{"gravatarHash":{"type":"string","default":""},"gravatarSize":{"type":"string","default":""},"align":{"type":"string","default":"none"}},"supports":{"anchor":true,"align":true,"className":true},"editorScript":"dlx-gravatar-block-editor","editorStyle":"dlx-gravatar-block-editor"}'),r=window.React,l=window.wp.blockEditor,o=window.wp.i18n,n=window.wp.components,c=window.wp.data,i=window.wp.apiFetch;var s=a.n(i);(0,e.registerBlockType)(t,{edit:a=>{const{attributes:e,setAttributes:t,clientId:i}=a,{gravatarHash:d,gravatarSize:v}=e,[g,u]=(0,r.useState)(!1),[p,h]=(0,r.useState)(""),[b,k]=(0,r.useState)(dlxGravatarBlock.avatarSizes[dlxGravatarBlock.avatarSizes.length-1].value),[m,w]=(0,r.useState)(d.length>0),[x,_]=(0,r.useState)(""),S=(0,c.useSelect)((a=>a("core/editor").getCurrentPostAttribute("author")),[]),E=(0,l.useBlockProps)({className:"dlx-gravatar-block"});(0,r.useEffect)((()=>{d.length>0&&y(d)}),[]);const y=(a="")=>{w(!0);let e=S;g||(e=p,a.length>0&&(e=a)),s()({path:`dlx-gravatar-block/v1/gravatar/${encodeURIComponent(e)}`,method:"GET",headers:{"Content-Type":"application/json","X-WP-Nonce":dlxGravatarBlock.nonce}}).then((a=>{if(!Object.keys(a).includes("code")){const e=a.emailHash;e.length>0&&t({gravatarHash:e});const r=a.avatarUrls[b];_(r)}})).catch((a=>{console.error(a)})).finally((()=>{w(!1)}))};if(m)return(0,r.createElement)("div",{...E},(0,r.createElement)(n.Spinner,null)," ",(0,o.__)("Loading Avatar...","dlx-gravatar-block"));const C=(0,r.createElement)(l.BlockControls,null,(0,r.createElement)(n.ToolbarGroup,null,(0,r.createElement)(n.ToolbarButton,{icon:"edit",title:(0,o.__)("Change","dlx-gravatar-block"),onClick:()=>{_(""),h("")}},(0,o.__)("Change","dlx-gravatar-block"))));return x?(0,r.createElement)("div",{...E},C,(0,r.createElement)("img",{src:x,alt:(0,o.__)("Gravatar","dlx-gravatar-block"),width:v||b,height:v||b})):(0,r.createElement)("div",{...E},(0,r.createElement)(n.ToggleControl,{label:(0,o.__)("Use author avatar","dlx-gravatar-block"),checked:g,onChange:a=>{u(a)},help:(0,o.__)("Use the post author's Gravatar instead of a custom Gravatar.","dlx-gravatar-block")}),!g&&(0,r.createElement)(r.Fragment,null,(0,r.createElement)(n.TextControl,{label:(0,o.__)("Username, ID, or email","dlx-gravatar-block"),value:p,onChange:a=>{h(a)}})),(0,r.createElement)(n.SelectControl,{label:(0,o.__)("Avatar Size","dlx-gravatar-block"),value:b,options:dlxGravatarBlock.avatarSizes,onChange:a=>{k(a)}}),(0,r.createElement)(n.Button,{variant:"primary",onClick:()=>{y()},disabled:!g&&0===p.trim().length},(0,o.__)("Get Avatar","dlx-gravatar-block")))},save:()=>null})})();